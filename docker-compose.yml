services:
  bot:
    build:
      context: ./bot
    environment:
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN}
      ELEVENLABS_API_KEY: ${ELEVENLABS_API_KEY}
    volumes:
      - bot-stats:/data
    restart: unless-stopped
    mem_limit: 512m
    cpus: "1.0"
    healthcheck:
      test:
        [
          "CMD",
          "bun",
          "-e",
          "fetch('http://127.0.0.1:3000/health').then(r => process.exit(r.ok ? 0 : 1)).catch(() => process.exit(1))",
        ]
      interval: 30s
      timeout: 5s
      retries: 3

volumes:
  bot-stats:
